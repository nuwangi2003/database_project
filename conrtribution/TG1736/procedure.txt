DELIMITER $$

CREATE PROCEDURE generate_student_academic_report(IN p_reg_no VARCHAR(15))
BEGIN
    DECLARE v_student_id VARCHAR(10);

    
    SELECT user_id INTO v_student_id
    FROM student
    WHERE reg_no = p_reg_no;

    
    IF v_student_id IS NULL THEN
        SELECT CONCAT('No student found with reg_no: ', p_reg_no) AS message;
    ELSE
        
        SELECT 
            s.reg_no,
            s.batch,
            s.department_id
        FROM student s
        WHERE s.user_id = v_student_id;

        
        SELECT 
            course_id,
            course_name,
            ca_marks,
            final_marks,
            ca_eligible,
            final_eligible,
            grade
        FROM student_marks_summary
        WHERE student_id = v_student_id;

        
        SELECT 
            academic_year,
            semester,
            semester_result
        FROM semester_pass_fail
        WHERE reg_no = p_reg_no;

        
        SELECT 
            academic_year,
            semester,
            cgpa,
            class_status
        FROM student_class
        WHERE reg_no = p_reg_no;
    END IF;

END$$

DELIMITER ;




CALL generate_student_academic_report('TG/2023/1701');
